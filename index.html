<!DOCTYPE html><html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ””ì½”ì¸ ì•ŒëŒë©ğŸ””</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; padding: 20px; background: #f9f9f9; }
    h2 { text-align: center; color: #6a5acd; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    select, input[type="number"], input[type="file"] {
      width: 100%; padding: 10px; margin-top: 5px;
      border: 1px solid #ccc; border-radius: 8px;
    }
    .button-group { text-align: center; margin-top: 20px; }
    button { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; }
    #register-btn { background-color: #6a5acd; color: white; }
    #result, #alert-list { margin-top: 20px; font-weight: bold; text-align: center; }
    .alert-item {
      margin: 5px auto; background: #eee; padding: 10px; border-radius: 6px;
      width: 90%; display: flex; justify-content: space-between; align-items: center;
    }
    .delete-btn {
      background-color: #ff4d4d; color: white; border: none;
      padding: 5px 10px; border-radius: 4px; cursor: pointer;
    }
  </style>
</head>
<body>
  <h2>ğŸ””ì½”ì¸ ì•ŒëŒë©ğŸ””</h2><label for="exchange">ê±°ë˜ì†Œ ì„ íƒ</label> <select id="exchange"> <option value="binance">ë°”ì´ë‚¸ìŠ¤</option> <option value="upbit">ì—…ë¹„íŠ¸</option> <option value="bitget">ë¹„íŠ¸ê²Ÿ</option> </select>

<label for="symbol">ì½”ì¸ ì„ íƒ</label> <select id="symbol"> <option value="BTCUSDT">ë¹„íŠ¸ì½”ì¸ (BTC)</option> <option value="ETHUSDT">ì´ë”ë¦¬ì›€ (ETH)</option> <option value="SOLUSDT">ì†”ë¼ë‚˜ (SOL)</option> <option value="XRPUSDT">ë¦¬í”Œ (XRP)</option> <option value="ADAUSDT">ì—ì´ë‹¤ (ADA)</option> </select>

  <p id="current-price">í˜„ì¬ê°€: -</p><label for="target-price">ì„¤ì •ê°€</label> <input type="number" id="target-price" placeholder="ì˜ˆ: 30000" />

<label for="condition">ì•Œë¦¼ ì¡°ê±´</label> <select id="condition"> <option value="over">ì„¤ì •ê°€ ì´ìƒ ë„ë‹¬ ì‹œ</option> <option value="under">ì„¤ì •ê°€ ì´í•˜ ë„ë‹¬ ì‹œ</option> </select>

<label for="frequency">ì•Œë¦¼ ì£¼ê¸°</label> <select id="frequency"> <option value="once">í•œ ë²ˆë§Œ ì•Œë¦¼</option> <option value="repeat">ì¡°ê±´ ë§Œì¡±í•  ë•Œë§ˆë‹¤ ì•Œë¦¼</option> <option value="interval-1m">1ë¶„ë§ˆë‹¤ ì•Œë¦¼</option> <option value="interval-5m">5ë¶„ë§ˆë‹¤ ì•Œë¦¼</option> <option value="until-off">ë‚´ê°€ ëŒ ë•Œê¹Œì§€</option> </select>

<label for="repeat-interval">ë°˜ë³µ ê°„ê²© (ì´ˆ)</label> <input type="number" id="repeat-interval" value="10" />

<label for="sound-select">ì•Œë¦¼ ì‚¬ìš´ë“œ</label> <select id="sound-select"> <option value="1">ğŸ”” ê¸°ë³¸ ë²¨ì†Œë¦¬</option> <option value="2">ğŸš¨ ê²½ê³  ì•ŒëŒ</option> <option value="3">ğŸ“¢ ì‚¬ì´ë Œ</option> <option value="custom">ğŸµ ë‚´ íŒŒì¼ ì—…ë¡œë“œ</option> </select> <input type="file" id="custom-sound" accept="audio/*" style="display:none;" />

  <div class="button-group">
    <button id="register-btn">ë“±ë¡</button>
  </div>  <div id="result"></div>
  <div id="alert-list"></div><audio id="sound-1" src="https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3"></audio> <audio id="sound-2" src="https://www.soundjay.com/button/sounds/beep-07.mp3"></audio> <audio id="sound-3" src="https://www.soundjay.com/button/sounds/beep-10.mp3"></audio>

  <script>
    const symbolSelect = document.getElementById('symbol');
    const exchangeSelect = document.getElementById('exchange');
    const priceLabel = document.getElementById('current-price');
    const result = document.getElementById('result');
    const alertList = document.getElementById('alert-list');
    const soundSelect = document.getElementById('sound-select');
    const customSoundInput = document.getElementById('custom-sound');
    let customSoundURL = null;
    const proxy = 'https://api.allorigins.win/raw?url=';

    symbolSelect.addEventListener('change', fetchCurrentPrice);
    exchangeSelect.addEventListener('change', fetchCurrentPrice);
    soundSelect.addEventListener('change', () => {
      customSoundInput.style.display = soundSelect.value === 'custom' ? 'block' : 'none';
    });
    customSoundInput.addEventListener('change', () => {
      const file = customSoundInput.files[0];
      if (file) customSoundURL = URL.createObjectURL(file);
    });

    async function fetchCurrentPrice() {
      const symbol = symbolSelect.value;
      const exchange = exchangeSelect.value;
      try {
        if (exchange === 'binance') {
          const res = await fetch(`https://api.binance.com/api/v3/ticker/price?symbol=${symbol}`);
          const data = await res.json();
          priceLabel.innerText = `í˜„ì¬ê°€: ${parseFloat(data.price).toLocaleString()} USDT`;
        } else if (exchange === 'upbit') {
          const market = "KRW-" + symbol.replace("USDT", "");
          const res = await fetch(`https://api.upbit.com/v1/ticker?markets=${market}`);
          const data = await res.json();
          priceLabel.innerText = `í˜„ì¬ê°€: ${parseFloat(data[0].trade_price).toLocaleString()} KRW`;
        } else if (exchange === 'bitget') {
          const url = `https://api.bitget.com/api/spot/v1/market/ticker?symbol=${symbol}`;
          const res = await fetch(proxy + encodeURIComponent(url));
          const obj = await res.json();
          const d = obj.data || (obj.data && obj.data.data);
          const close = parseFloat(d.close);
          priceLabel.innerText = `í˜„ì¬ê°€: ${close.toLocaleString()} USDT`;
        }
      } catch {
        priceLabel.innerText = "í˜„ì¬ê°€: - (ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨)";
      }
    }

    window.addEventListener('load', () => {
      fetchCurrentPrice();
      setInterval(fetchCurrentPrice, 5000);
    });

    document.getElementById('register-btn').addEventListener('click', () => {
      const symbolText = symbolSelect.options[symbolSelect.selectedIndex].text;
      const symbol = symbolSelect.value;
      const target = parseFloat(document.getElementById('target-price').value);
      const condition = document.getElementById('condition').value;
      const frequency = document.getElementById('frequency').value;
      const repeatInterval = parseInt(document.getElementById('repeat-interval').value);
      const sound = soundSelect.value;
      const conditionText = condition === 'over' ? 'ì´ìƒ' : 'ì´í•˜';
      const intervalMap = { 'interval-1m': 60, 'interval-5m': 300 };

      if (!target || isNaN(target)) {
        result.innerText = "â— ì„¤ì •ê°€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.";
        return;
      }

      const alertItem = document.createElement('div');
      alertItem.className = 'alert-item';
      alertItem.innerHTML = `<span>${symbolText} - ${target} ${conditionText}</span><button class=\"delete-btn\">ì‚­ì œ</button>`;
      alertItem.querySelector('button').onclick = () => alertItem.remove();
      alertList.appendChild(alertItem);
      result.innerText = "âœ… ì•Œë¦¼ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.";

      async function checkCondition() {
        try {
          const res = await fetch(`https://api.binance.com/api/v3/ticker/price?symbol=${symbol}`);
          const data = await res.json();
          const current = parseFloat(data.price);
          return (condition === 'over' && current >= target) || (condition === 'under' && current <= target);
        } catch {
          return false;
        }
      }

      async function loop() {
        const matched = await checkCondition();
        if (matched) {
          if (sound === 'custom' && customSoundURL) {
            new Audio(customSoundURL).play();
          } else {
            document.getElementById(`sound-${sound}`).play();
          }
          result.innerText = "ğŸ‰ ì¡°ê±´ ë§Œì¡±! ì•ŒëŒ ìš¸ë¦¼!";
          if (frequency === 'once') return;
        }
        if (frequency !== 'once') {
          let next = repeatInterval;
          if (intervalMap[frequency]) next = intervalMap[frequency];
          setTimeout(loop, next * 1000);
        }
      }
      loop();
    });
  </script></body>
</html>
