<!DOCTYPE html><html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ””ì½”ì¸ ì•ŒëŒë©ğŸ””</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Roboto', sans-serif; background: #f3f4f6; margin: 0; padding: 20px; }
    .container { max-width: 500px; margin: auto; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    h2 { text-align: center; color: #6b21a8; }
    .field { margin-bottom: 16px; }
    label { display: block; margin-bottom: 8px; font-weight: bold; }
    select, input { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 8px; }
    #price { font-size: 1.2em; margin-bottom: 16px; }
    #register { width: 100%; padding: 12px; background: #6b21a8; color: #fff; border: none; border-radius: 8px; cursor: pointer; }
    #alarm-list { margin-top: 20px; }
    .alarm-item { display: flex; justify-content: space-between; background: #f9fafb; padding: 10px; border-radius: 8px; margin-bottom: 8px; }
    .alarm-item button { background: #dc2626; color: #fff; border: none; border-radius: 6px; padding: 6px 12px; cursor: pointer; }
  </style>
</head>
<body>
  <div class="container">
    <h2>ğŸ””ì½”ì¸ ì•ŒëŒë©ğŸ””</h2>
    <div class="field">
      <label for="exchange">ê±°ë˜ì†Œ ì„ íƒ</label>
      <select id="exchange">
        <option value="binance">ë°”ì´ë‚¸ìŠ¤</option>
        <option value="upbit">ì—…ë¹„íŠ¸</option>
        <option value="bitget">ë¹„íŠ¸ê²Ÿ</option>
      </select>
    </div>
    <div class="field">
      <label for="coin">ì½”ì¸ ì„ íƒ</label>
      <select id="coin">
        <option value="BTC">ë¹„íŠ¸ì½”ì¸ (BTC)</option>
        <option value="ETH">ì´ë”ë¦¬ì›€ (ETH)</option>
        <option value="XRP">ë¦¬í”Œ (XRP)</option>
        <option value="SOL">ì†”ë¼ë‚˜ (SOL)</option>
        <option value="ADA">ì—ì´ë‹¤ (ADA)</option>
        <option value="DOGE">ë„ì§€ì½”ì¸ (DOGE)</option>
        <option value="AVAX">ì•„ë°œë€ì²´ (AVAX)</option>
      </select>
    </div>
    <div id="price">í˜„ì¬ê°€: -</div>
    <div class="field">
      <label for="target">ì„¤ì •ê°€</label>
      <input type="number" id="target" placeholder="ì˜ˆ: 30000">
    </div>
    <div class="field">
      <label for="condition">ì•Œë¦¼ ì¡°ê±´</label>
      <select id="condition">
        <option value="above">ì„¤ì •ê°€ ì´ìƒ ë„ë‹¬ ì‹œ</option>
        <option value="below">ì„¤ì •ê°€ ì´í•˜ ë„ë‹¬ ì‹œ</option>
      </select>
    </div>
    <button id="register">ë“±ë¡</button>
    <div id="alarm-list"></div>
  </div>
  <script>
    const exchangeSelect = document.getElementById('exchange');
    const coinSelect = document.getElementById('coin');
    const priceDiv = document.getElementById('price');
    const targetInput = document.getElementById('target');
    const condSelect = document.getElementById('condition');
    const registerBtn = document.getElementById('register');
    const alarmList = document.getElementById('alarm-list');let alarms = [];

async function fetchPrice() {
  const ex = exchangeSelect.value;
  const sym = coinSelect.value;
  let url;
  if (ex === 'upbit') {
    url = `https://api.upbit.com/v1/ticker?markets=KRW-${sym}`;
  } else if (ex === 'binance') {
    url = `https://api.binance.com/api/v3/ticker/price?symbol=${sym}USDT`;
  } else if (ex === 'bitget') {
    url = `https://api.codetabs.com/v1/proxy?quest=https://api.bitget.com/api/spot/v1/market/ticker?symbol=${sym}USDT`;
  }
  try {
    const res = await fetch(url);
    const data = await res.json();
    let p;
    if (ex === 'upbit') p = data[0].trade_price;
    if (ex === 'binance') p = parseFloat(data.price);
    if (ex === 'bitget') {
      let payload = data.data;
      if (Array.isArray(payload)) payload = payload[0];
      p = parseFloat(payload.last);
    }
    const unit = ex === 'upbit' ? 'KRW' : 'USDT';
    priceDiv.textContent = `í˜„ì¬ê°€: ${p.toLocaleString(undefined, { minimumFractionDigits: ex === 'upbit' ? 0 : 2 })} ${unit}`;
    checkAlarms(p);
  } catch (e) {
    priceDiv.textContent = `í˜„ì¬ê°€: - (ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨)`;
  }
}

function checkAlarms(price) {
  alarms.forEach((alarm, idx) => {
    if (!alarm.triggered) {
      if ((alarm.cond === 'above' && price >= alarm.target) ||
          (alarm.cond === 'below' && price <= alarm.target)) {
        alert(`ğŸ”” ${alarm.coin} ${alarm.target} ${alarm.cond === 'above' ? 'ì´ìƒ' : 'ì´í•˜'} ë„ë‹¬!`);
        alarm.triggered = true;
        renderAlarms();
      }
    }
  });
}

function renderAlarms() {
  alarmList.innerHTML = '';
  alarms.forEach((alarm, idx) => {
    const div = document.createElement('div');
    div.className = 'alarm-item';
    div.innerHTML = `
      <span>${alarm.coin} - ${alarm.target} ${alarm.cond === 'above' ? 'ì´ìƒ' : 'ì´í•˜'}</span>
      <button data-idx="${idx}">ì‚­ì œ</button>
    `;
    alarmList.appendChild(div);
  });
  document.querySelectorAll('.alarm-item button').forEach(btn => {
    btn.onclick = () => {
      alarms.splice(btn.dataset.idx, 1);
      renderAlarms();
    };
  });
}

registerBtn.onclick = () => {
  const newAlarm = {
    coin: coinSelect.options[coinSelect.selectedIndex].text,
    target: Number(targetInput.value),
    cond: condSelect.value,
    triggered: false
  };
  if (!isNaN(newAlarm.target)) {
    alarms.push(newAlarm);
    renderAlarms();
  }
};

exchangeSelect.onchange = fetchPrice;
coinSelect.onchange = fetchPrice;
setInterval(fetchPrice, 2000); // 2ì´ˆë§ˆë‹¤ ê°±ì‹ 
fetchPrice();

  </script>
</body>
</html>
